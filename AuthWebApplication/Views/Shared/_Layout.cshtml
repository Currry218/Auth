@{
    var isGuest = ViewBag.Nav == "Guest";
}

<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <script type="importmap"></script>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/AuthWebApplication.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.min.js"
        integrity="sha512-Gs+PsXsGkmr+15rqObPJbenQ2wB3qYvTHuJO6YJzPe/dTLvhy0fmae2BcnaozxDo5iaF8emzmCZWbQ1XXiX2Ig=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.css"
        integrity="sha512-2eMmukTZtvwlfQoG8ztapwAH5fXaQBzaMqdljLopRSA0i6YKM8kBAOrSSykxu9NN9HrtD45lIqfONLII2AFL/Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.js"
        integrity="sha512-vUJTqeDCu0MKkOhuI83/MEX5HSNPW+Lw46BA775bAWIp1Zwgz3qggia/t2EnSGB9GoS2Ln6npDmbJTdNhHy1Yw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.min.css"
        integrity="sha512-zxBiDORGDEAYDdKLuYU9X/JaJo/DPzE42UubfBw9yg8Qvb2YRRIQ8v4KsGHOx2H1/+sdSXyXxLXv5r7tHc9ygg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>

<body>
    @await Html.PartialAsync("Toast.cshtml")
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
            <div class="container-fluid">
                <a class="navbar-brand bi bi-shield-shaded fs-3" asp-area="" asp-controller="" asp-action=""> AUTH</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-collapse collapse d-flex justify-content-between">
                    <ul class="navbar-nav flex-grow-1">
                        @if (isGuest)
                        {
                            @await Html.PartialAsync("_NavbarGuest")
                        }
                        else
                        {
                            @await Html.PartialAsync("_NavbarUser")
                        }

                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="">
        <main role="main" class="my-2 ">
            @RenderBody()
        </main>
        </script>
        <script>
            @* INPUT MASK *@
                document.addEventListener('DOMContentLoaded', () => {
                    for (const el of document.querySelectorAll("[placeholder][data-slots]")) {
                        const pattern = el.getAttribute("placeholder"),
                            slots = new Set(el.dataset.slots || "_"),
                            prev = (j => Array.from(pattern, (c, i) => slots.has(c) ? j = i + 1 : j))(0),
                            first = [...pattern].findIndex(c => slots.has(c)),
                            accept = new RegExp(el.dataset.accept || "\\d", "g"),
                            clean = input => {
                                input = input.match(accept) || [];
                                return Array.from(pattern, c =>
                                    input[0] === c || slots.has(c) ? input.shift() || c : c
                                );
                            },
                            format = () => {
                                const [i, j] = [el.selectionStart, el.selectionEnd].map(i => {
                                    i = clean(el.value.slice(0, i)).findIndex(c => slots.has(c));
                                    return i < 0 ? prev.at(-1) : back ? prev[i - 1] || first : i;
                                });
                                el.value = clean(el.value).join("");
                                el.setSelectionRange(i, j);
                                back = false;
                            };
                        let back = false;
                        el.addEventListener("keydown", (e) => back = e.key === "Backspace");
                        el.addEventListener("input", format);
                        el.addEventListener("focus", format);
                        el.addEventListener("blur", () => el.value === pattern && (el.value = ""));
                    }
                });
        </script>
    </div>
    <footer class="border-top footer text-muted mt-5">
        <div class="text-center">
            &copy; 2025 
        </div>
    </footer>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>